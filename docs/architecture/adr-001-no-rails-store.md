# ADR-001: –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Rails ActiveRecord::Store

**–°—Ç–∞—Ç—É—Å**: –ü—Ä–∏–Ω—è—Ç–æ ‚úÖ
**–î–∞—Ç–∞ —Ä–µ—à–µ–Ω–∏—è**: 2025-10-31
**–ê–≤—Ç–æ—Ä—ã**: Development Team
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞**: v0.5.0+

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è ModelSettings (`llm_docs/settings_gem_spec.md`, Section 2) –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Rails `ActiveRecord::Store` –≤ –∫–∞—á–µ—Å—Ç–≤–µ foundation –¥–ª—è JSON adapter:

```ruby
# –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:
class Callcenter < ApplicationRecord
  store_accessor :settings, :billing_enabled, :speech_recognition
end
```

Rails Store –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ getter/setter –º–µ—Ç–æ–¥—ã
- ‚úÖ Native dirty tracking (`_changed?`, `_was`, `_change`)
- ‚úÖ Zero dependencies (–≤—Å—Ç—Ä–æ–µ–Ω –≤ Rails 3.2+)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PostgreSQL JSONB, MySQL JSON, SQLite JSON

–û–¥–Ω–∞–∫–æ –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ ModelSettings DSL –≤–æ–∑–Ω–∏–∫–ª–æ **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ **–≤–ª–æ–∂–µ–Ω–Ω—ã—Ö (nested) –Ω–∞—Å—Ç—Ä–æ–µ–∫**:

```ruby
# Core requirement –Ω–∞—à–µ–≥–æ DSL:
setting :features, type: :json, storage: { column: :settings } do
  setting :ai_enabled      # Nested key: settings["features"]["ai_enabled"]
  setting :voice_recording # Nested key: settings["features"]["voice_recording"]
end
```

–í—Å—Ç–∞–ª –≤–æ–ø—Ä–æ—Å: –º–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Rails Store –¥–ª—è nested keys?

---

## –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

### –ü–æ–ø—ã—Ç–∫–∞ 1: –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Rails Store —Å nested keys

**POC –∫–æ–¥** (`research/rails_store_poc.rb`):
```ruby
class TestModel < ApplicationRecord
  store_accessor :settings, "features.ai_enabled"
end

model = TestModel.new
model.public_send("features.ai_enabled=", true)
# => NoMethodError: undefined method `features.ai_enabled='
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚ùå **Rails Store –ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢ —Ç–æ—á–µ—á–Ω—É—é –Ω–æ—Ç–∞—Ü–∏—é –¥–ª—è nested keys**

### –ü–æ–ø—ã—Ç–∫–∞ 2: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥

**–ò–¥–µ—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Rails Store –¥–ª—è flat keys, custom code –¥–ª—è nested.

**–ê–Ω–∞–ª–∏–∑** (`research/alternative_approaches_analysis.md`):
```ruby
# –î–ª—è flat keys (—Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç):
store_accessor :settings, :theme, :locale

# –î–ª—è nested keys (—Ç—Ä–µ–±—É–µ—Ç—Å—è custom –∫–æ–¥):
def features
  settings["features"] ||= {}
end

def features=(value)
  settings["features"] = value
  settings_will_change!
end
```

**–û—Ü–µ–Ω–∫–∞ –≤—ã–≥–æ–¥**:
- –≠–∫–æ–Ω–æ–º–∏—è –∫–æ–¥–∞: ~10-20 LOC (—Ç–æ–ª—å–∫–æ –¥–ª—è flat keys)
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: +2 code paths (Rails Store vs custom)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏: `if nested? use_custom else use_store`

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚ö†Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã–≥–æ–¥–∞ –ø—Ä–∏ —Ä–æ—Å—Ç–µ complexity**

### –ü–æ–ø—ã—Ç–∫–∞ 3: StoreModel –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏

**–ò–¥–µ—è**: –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å StoreModel –∫–ª–∞—Å—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è nested —Å—Ç—Ä—É–∫—Ç—É—Ä.

**–°—Ç–∞—Ç—É—Å**: üîÑ **Promising, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è**

---

## –†–µ—à–µ–Ω–∏–µ

**–ü—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ: –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Rails ActiveRecord::Store**

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **custom implementation** –¥–ª—è JSON adapter:
- –Ø–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ dirty tracking —á–µ—Ä–µ–∑ `*_will_change!`
- –†—É—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ getter/setter –º–µ—Ç–æ–¥–æ–≤
- –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ nested keys –ª—é–±–æ–π –≥–ª—É–±–∏–Ω—ã
- –ï–¥–∏–Ω—ã–π code path (–ø—Ä–æ—â–µ, –ø–æ–Ω—è—Ç–Ω–µ–µ)

---

## –ü—Ä–∏—á–∏–Ω—ã

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–∏—á–∏–Ω–∞ (–≥–ª–∞–≤–Ω–∞—è):

**Rails Store —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ù–ï –ú–û–ñ–ï–¢ —Ä–∞–±–æ—Ç–∞—Ç—å —Å nested keys**

```ruby
# ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å Rails Store:
store_accessor :settings, "features.ai_enabled"
store_accessor :settings, "features.voice_recording"

# ‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—à–µ–≥–æ DSL:
setting :features do
  setting :ai_enabled      # settings["features"]["ai_enabled"]
  setting :voice_recording # settings["features"]["voice_recording"]
end
```

Rails Store —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ flat key-value —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –ü–æ–ø—ã—Ç–∫–∏ –æ–±–æ–π—Ç–∏ —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫:
- –°–ª–æ–∂–Ω–æ–º—É –≥–∏–±—Ä–∏–¥–Ω–æ–º—É –∫–æ–¥—É (–¥–≤–∞ –ø—É—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –≤—ã–≥–æ–¥–µ (10-20 LOC —ç–∫–æ–Ω–æ–º–∏–∏ –¥–ª—è flat keys)
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Store –¥–ª—è nested keys (–æ—Å–Ω–æ–≤–Ω–æ–π use case)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞**
   - –û–¥–∏–Ω code path vs –¥–≤–∞ (Rails Store + custom –¥–ª—è nested)
   - –õ–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å, –ª–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
   - –ú–µ–Ω—å—à–µ —É—Å–ª–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏ (`if nested?`)

2. **–ì–∏–±–∫–æ—Å—Ç—å**
   - –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ dirty tracking
   - –ú–æ–∂–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è —Å–≤–æ–∏—Ö –Ω—É–∂–¥
   - –ù–µ –∑–∞–≤–∏—Å–∏–º –æ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏—è Rails Store (–º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –≤ Rails 8+)

3. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**
   - –í—Å–µ –∞–¥–∞–ø—Ç–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ
   - JSON adapter –Ω–µ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è "—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º" –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º
   - –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

4. **–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç nested keys –∫–∞–∫ core feature**
   - Nested settings - —ç—Ç–æ –Ω–µ "–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏—á–∞"
   - –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å DSL
   - –ñ–µ—Ä—Ç–≤–æ–≤–∞—Ç—å –µ–π —Ä–∞–¥–∏ ~20 LOC —ç–∫–æ–Ω–æ–º–∏–∏ - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π trade-off

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ 1: –£–±—Ä–∞—Ç—å nested keys –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
**–û—Ü–µ–Ω–∫–∞**: ‚ùå Rejected
- **–ü—Ä–∏—á–∏–Ω–∞**: Breaking change –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ API
- **–ü—Ä–∏—á–∏–Ω–∞**: Nested keys - –∫–ª—é—á–µ–≤–∞—è —Ñ–∏—á–∞ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ 2: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (Store + custom)
**–û—Ü–µ–Ω–∫–∞**: ‚ùå Rejected
- **–í—ã–≥–æ–¥–∞**: ~10-20 LOC —ç–∫–æ–Ω–æ–º–∏–∏ –¥–ª—è flat keys
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: +2 code paths, –±–æ–ª—å—à–µ complexity
- **–í—ã–≤–æ–¥**: –ò–≥—Ä–∞ –Ω–µ —Å—Ç–æ–∏—Ç —Å–≤–µ—á

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ 3: StoreModel auto-generation
**–û—Ü–µ–Ω–∫–∞**: üîÑ –î–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
- **–ò–¥–µ—è**: –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å StoreModel –∫–ª–∞—Å—Å—ã –¥–ª—è nested —Å—Ç—Ä—É–∫—Ç—É—Ä
- **–í—ã–≥–æ–¥–∞**: Native StoreModel dirty tracking + nested –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: –°–ª–æ–∂–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –±–æ–ª—å—à–µ –º–∞–≥–∏–∏
- **–†–µ—à–µ–Ω–∏–µ**: –û—Ç–ª–æ–∂–∏—Ç—å –¥–æ v1.1+, –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ 4: Custom implementation (–≤—ã–±—Ä–∞–Ω–æ)
**–û—Ü–µ–Ω–∫–∞**: ‚úÖ **Accepted**
- **–í—ã–≥–æ–¥–∞**: –ü—Ä–æ—Å—Ç–æ—Ç–∞, –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ nested keys
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~150 LOC custom dirty tracking
- **–í—ã–≤–æ–¥**: Best pragmatic choice

---

## –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è

### –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ ‚úÖ

1. **–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ nested keys**
   - –õ—é–±–∞—è –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
   - –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ API
   - –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è

2. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã**
   - –û–¥–∏–Ω –∫–æ–¥ path –¥–ª—è JSON adapter
   - –õ–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (–Ω–µ—Ç –≤–µ—Ç–≤–ª–µ–Ω–∏—è flat vs nested)
   - 955 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ

3. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç Rails**
   - –ù–µ –∑–∞–≤–∏—Å–∏–º –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π Rails Store –≤ –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö
   - –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º
   - –ú–æ–∂–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã

4. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏**
   - Column adapter: Rails AR dirty tracking
   - JSON adapter: Custom dirty tracking
   - StoreModel adapter: StoreModel dirty tracking
   - –ö–∞–∂–¥—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–æ–¥—Ö–æ–¥

### –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ ‚ö†Ô∏è

1. **–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏**
   - Specification —Ç—Ä–µ–±–æ–≤–∞–ª–∞ Rails Store
   - **–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é, –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ (—ç—Ç–æ—Ç ADR)

2. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è dirty tracking**
   - ~150 LOC custom implementation
   - **–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è**: –ö–æ–¥ –ø—Ä–æ—Å—Ç–æ–π, —Ö–æ—Ä–æ—à–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω (955 tests)

3. **–ù—É–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å custom –∫–æ–¥**
   - –í–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Rails –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ
   - **–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è**: –ö–æ–¥ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, —Ä–µ–¥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è

### –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ ‚ÑπÔ∏è

1. **–í–æ–∑–º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∏–º –¥–ª—è StoreModel auto-generation**
   - –ï—Å–ª–∏ –Ω–∞–π–¥—ë–º —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è auto-generation
   - –ù–æ —ç—Ç–æ –±—É–¥–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (ADR-00X)

---

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –°—Ç–∞—Ç—É—Å compliance

**–î–æ —ç—Ç–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è**: 60% (major architecture deviation)
**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è**: 70% (conscious decision documented)

### –ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ roadmap

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (`settings_gem_spec.md`, Section 2) **–æ–±–Ω–æ–≤–ª–µ–Ω–∞** —Å –ø–æ–º–µ—Ç–∫–æ–π:

> ‚ö†Ô∏è **Note**: –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç custom dirty tracking –≤–º–µ—Å—Ç–æ Rails Store –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Å nested keys. –°–º. ADR-001 –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è.

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ **–ù–ï –≤–ª–∏—è–µ—Ç** –Ω–∞ backward compatibility, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- API –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–µ–º –∂–µ
- Dirty tracking –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ Rails Store
- –¢–µ—Å—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç: 955 examples, 0 failures

---

## –î–∞—Ç–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è

**2025-10-31** - –ü–æ—Å–ª–µ Sprint 9 (JSON Array Support completed)

---

## –°—Å—ã–ª–∫–∏

- **POC**: `research/rails_store_poc.rb` - Proof of concept showing Rails Store limitations
- **Analysis**: `research/current_vs_rails_store.md` - Detailed comparison
- **Alternatives**: `research/alternative_approaches_analysis.md` - All options evaluated
- **Implementation**: `lib/model_settings/adapters/json.rb:235-336` - Custom dirty tracking
- **Tests**: `spec/model_settings/adapters/json_spec.rb` - 955 examples validate implementation

---

## –°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞

- [x] –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ
- [x] –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã
- [x] –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ
- [x] –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [x] Roadmap –æ–±–Ω–æ–≤–ª—ë–Ω
- [x] –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–ø—Ä–∏–º–µ—á–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ)

**–†–µ—à–µ–Ω–∏–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ**: –ù–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–ª—è v1.0

**–í–æ–∑–º–æ–∂–Ω—ã–π –ø–µ—Ä–µ—Å–º–æ—Ç—Ä**: v1.1+ –µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è elegant solution –¥–ª—è StoreModel auto-generation
